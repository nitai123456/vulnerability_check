from typing import Callable, Optional

from paramiko.client import SSHClient
from pydantic import BaseModel
from models.connection_info import ConnectionInfo


class Vulnerability(BaseModel):
    name: str
    check: Callable[[SSHClient, ConnectionInfo], bool]
    mitigation: Optional[Callable[[SSHClient, ConnectionInfo], bool]]

    def __str__(self):
        return self.name
